var dbits,canary=0xdeadbeefcafe,j_lm=(canary&16777215)==15715070;function BigInteger(e,i,s){e!=null&&(typeof e=="number"?this.fromNumber(e,i,s):i==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,i))}function nbi(){return new BigInteger(null)}function am1(e,i,s,o,n,r){for(;--r>=0;){var h=i*this[e++]+s[o]+n;n=Math.floor(h/67108864),s[o++]=h&67108863}return n}function am2(e,i,s,o,n,r){for(var h=i&32767,f=i>>15;--r>=0;){var u=this[e]&32767,a=this[e++]>>15,p=f*u+a*h;u=h*u+((p&32767)<<15)+s[o]+(n&1073741823),n=(u>>>30)+(p>>>15)+f*a+(n>>>30),s[o++]=u&1073741823}return n}function am3(e,i,s,o,n,r){for(var h=i&16383,f=i>>14;--r>=0;){var u=this[e]&16383,a=this[e++]>>14,p=f*u+a*h;u=h*u+((p&16383)<<14)+s[o]+n,n=(u>>28)+(p>>14)+f*a,s[o++]=u&268435455}return n}j_lm&&navigator.appName=="Microsoft Internet Explorer"?(BigInteger.prototype.am=am2,dbits=30):j_lm&&navigator.appName!="Netscape"?(BigInteger.prototype.am=am1,dbits=26):(BigInteger.prototype.am=am3,dbits=28),BigInteger.prototype.DB=dbits,BigInteger.prototype.DM=(1<<dbits)-1,BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP),BigInteger.prototype.F1=BI_FP-dbits,BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=new Array,rr,vv;for(rr=48,vv=0;vv<=9;++vv)BI_RC[rr++]=vv;for(rr=97,vv=10;vv<36;++vv)BI_RC[rr++]=vv;for(rr=65,vv=10;vv<36;++vv)BI_RC[rr++]=vv;function int2char(e){return BI_RM.charAt(e)}function intAt(e,i){var s=BI_RC[e.charCodeAt(i)];return s==null?-1:s}function bnpCopyTo(e){for(var i=this.t-1;i>=0;--i)e[i]=this[i];e.t=this.t,e.s=this.s}function bnpFromInt(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0}function nbv(e){var i=nbi();return i.fromInt(e),i}function bnpFromString(e,i){var s;if(i==16)s=4;else if(i==8)s=3;else if(i==256)s=8;else if(i==2)s=1;else if(i==32)s=5;else if(i==4)s=2;else{this.fromRadix(e,i);return}this.t=0,this.s=0;for(var o=e.length,n=!1,r=0;--o>=0;){var h=s==8?e[o]&255:intAt(e,o);if(h<0){e.charAt(o)=="-"&&(n=!0);continue}n=!1,r==0?this[this.t++]=h:r+s>this.DB?(this[this.t-1]|=(h&(1<<this.DB-r)-1)<<r,this[this.t++]=h>>this.DB-r):this[this.t-1]|=h<<r,r+=s,r>=this.DB&&(r-=this.DB)}s==8&&e[0]&128&&(this.s=-1,r>0&&(this[this.t-1]|=(1<<this.DB-r)-1<<r)),this.clamp(),n&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t}function bnToString(e){if(this.s<0)return"-"+this.negate().toString(e);var i;if(e==16)i=4;else if(e==8)i=3;else if(e==2)i=1;else if(e==32)i=5;else if(e==4)i=2;else return this.toRadix(e);var s=(1<<i)-1,o,n=!1,r="",h=this.t,f=this.DB-h*this.DB%i;if(h-- >0)for(f<this.DB&&(o=this[h]>>f)>0&&(n=!0,r=int2char(o));h>=0;)f<i?(o=(this[h]&(1<<f)-1)<<i-f,o|=this[--h]>>(f+=this.DB-i)):(o=this[h]>>(f-=i)&s,f<=0&&(f+=this.DB,--h)),o>0&&(n=!0),n&&(r+=int2char(o));return n?r:"0"}function bnNegate(){var e=nbi();return BigInteger.ZERO.subTo(this,e),e}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(e){var i=this.s-e.s;if(i!=0)return i;var s=this.t;if(i=s-e.t,i!=0)return this.s<0?-i:i;for(;--s>=0;)if((i=this[s]-e[s])!=0)return i;return 0}function nbits(e){var i=1,s;return(s=e>>>16)!=0&&(e=s,i+=16),(s=e>>8)!=0&&(e=s,i+=8),(s=e>>4)!=0&&(e=s,i+=4),(s=e>>2)!=0&&(e=s,i+=2),(s=e>>1)!=0&&(e=s,i+=1),i}function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(e,i){var s;for(s=this.t-1;s>=0;--s)i[s+e]=this[s];for(s=e-1;s>=0;--s)i[s]=0;i.t=this.t+e,i.s=this.s}function bnpDRShiftTo(e,i){for(var s=e;s<this.t;++s)i[s-e]=this[s];i.t=Math.max(this.t-e,0),i.s=this.s}function bnpLShiftTo(e,i){var s=e%this.DB,o=this.DB-s,n=(1<<o)-1,r=Math.floor(e/this.DB),h=this.s<<s&this.DM,f;for(f=this.t-1;f>=0;--f)i[f+r+1]=this[f]>>o|h,h=(this[f]&n)<<s;for(f=r-1;f>=0;--f)i[f]=0;i[r]=h,i.t=this.t+r+1,i.s=this.s,i.clamp()}function bnpRShiftTo(e,i){i.s=this.s;var s=Math.floor(e/this.DB);if(s>=this.t){i.t=0;return}var o=e%this.DB,n=this.DB-o,r=(1<<o)-1;i[0]=this[s]>>o;for(var h=s+1;h<this.t;++h)i[h-s-1]|=(this[h]&r)<<n,i[h-s]=this[h]>>o;o>0&&(i[this.t-s-1]|=(this.s&r)<<n),i.t=this.t-s,i.clamp()}function bnpSubTo(e,i){for(var s=0,o=0,n=Math.min(e.t,this.t);s<n;)o+=this[s]-e[s],i[s++]=o&this.DM,o>>=this.DB;if(e.t<this.t){for(o-=e.s;s<this.t;)o+=this[s],i[s++]=o&this.DM,o>>=this.DB;o+=this.s}else{for(o+=this.s;s<e.t;)o-=e[s],i[s++]=o&this.DM,o>>=this.DB;o-=e.s}i.s=o<0?-1:0,o<-1?i[s++]=this.DV+o:o>0&&(i[s++]=o),i.t=s,i.clamp()}function bnpMultiplyTo(e,i){var s=this.abs(),o=e.abs(),n=s.t;for(i.t=n+o.t;--n>=0;)i[n]=0;for(n=0;n<o.t;++n)i[n+s.t]=s.am(0,o[n],i,n,0,s.t);i.s=0,i.clamp(),this.s!=e.s&&BigInteger.ZERO.subTo(i,i)}function bnpSquareTo(e){for(var i=this.abs(),s=e.t=2*i.t;--s>=0;)e[s]=0;for(s=0;s<i.t-1;++s){var o=i.am(s,i[s],e,2*s,0,1);(e[s+i.t]+=i.am(s+1,2*i[s],e,2*s+1,o,i.t-s-1))>=i.DV&&(e[s+i.t]-=i.DV,e[s+i.t+1]=1)}e.t>0&&(e[e.t-1]+=i.am(s,i[s],e,2*s,0,1)),e.s=0,e.clamp()}function bnpDivRemTo(e,i,s){var o=e.abs();if(!(o.t<=0)){var n=this.abs();if(n.t<o.t){i!=null&&i.fromInt(0),s!=null&&this.copyTo(s);return}s==null&&(s=nbi());var r=nbi(),h=this.s,f=e.s,u=this.DB-nbits(o[o.t-1]);u>0?(o.lShiftTo(u,r),n.lShiftTo(u,s)):(o.copyTo(r),n.copyTo(s));var a=r.t,p=r[a-1];if(p!=0){var y=p*(1<<this.F1)+(a>1?r[a-2]>>this.F2:0),T=this.FV/y,g=(1<<this.F1)/y,d=1<<this.F2,c=s.t,v=c-a,l=i==null?nbi():i;for(r.dlShiftTo(v,l),s.compareTo(l)>=0&&(s[s.t++]=1,s.subTo(l,s)),BigInteger.ONE.dlShiftTo(a,l),l.subTo(r,r);r.t<a;)r[r.t++]=0;for(;--v>=0;){var m=s[--c]==p?this.DM:Math.floor(s[c]*T+(s[c-1]+d)*g);if((s[c]+=r.am(0,m,s,v,0,a))<m)for(r.dlShiftTo(v,l),s.subTo(l,s);s[c]<--m;)s.subTo(l,s)}i!=null&&(s.drShiftTo(a,i),h!=f&&BigInteger.ZERO.subTo(i,i)),s.t=a,s.clamp(),u>0&&s.rShiftTo(u,s),h<0&&BigInteger.ZERO.subTo(s,s)}}}function bnMod(e){var i=nbi();return this.abs().divRemTo(e,null,i),this.s<0&&i.compareTo(BigInteger.ZERO)>0&&e.subTo(i,i),i}function Classic(e){this.m=e}function cConvert(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function cRevert(e){return e}function cReduce(e){e.divRemTo(this.m,null,e)}function cMulTo(e,i,s){e.multiplyTo(i,s),this.reduce(s)}function cSqrTo(e,i){e.squareTo(i),this.reduce(i)}Classic.prototype.convert=cConvert,Classic.prototype.revert=cRevert,Classic.prototype.reduce=cReduce,Classic.prototype.mulTo=cMulTo,Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if(this.t<1)return 0;var e=this[0];if(!(e&1))return 0;var i=e&3;return i=i*(2-(e&15)*i)&15,i=i*(2-(e&255)*i)&255,i=i*(2-((e&65535)*i&65535))&65535,i=i*(2-e*i%this.DV)%this.DV,i>0?this.DV-i:-i}function Montgomery(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function montConvert(e){var i=nbi();return e.abs().dlShiftTo(this.m.t,i),i.divRemTo(this.m,null,i),e.s<0&&i.compareTo(BigInteger.ZERO)>0&&this.m.subTo(i,i),i}function montRevert(e){var i=nbi();return e.copyTo(i),this.reduce(i),i}function montReduce(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var i=0;i<this.m.t;++i){var s=e[i]&32767,o=s*this.mpl+((s*this.mph+(e[i]>>15)*this.mpl&this.um)<<15)&e.DM;for(s=i+this.m.t,e[s]+=this.m.am(0,o,e,i,0,this.m.t);e[s]>=e.DV;)e[s]-=e.DV,e[++s]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function montSqrTo(e,i){e.squareTo(i),this.reduce(i)}function montMulTo(e,i,s){e.multiplyTo(i,s),this.reduce(s)}Montgomery.prototype.convert=montConvert,Montgomery.prototype.revert=montRevert,Montgomery.prototype.reduce=montReduce,Montgomery.prototype.mulTo=montMulTo,Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return(this.t>0?this[0]&1:this.s)==0}function bnpExp(e,i){if(e>4294967295||e<1)return BigInteger.ONE;var s=nbi(),o=nbi(),n=i.convert(this),r=nbits(e)-1;for(n.copyTo(s);--r>=0;)if(i.sqrTo(s,o),(e&1<<r)>0)i.mulTo(o,n,s);else{var h=s;s=o,o=h}return i.revert(s)}function bnModPowInt(e,i){var s;return e<256||i.isEven()?s=new Classic(i):s=new Montgomery(i),this.exp(e,s)}BigInteger.prototype.copyTo=bnpCopyTo,BigInteger.prototype.fromInt=bnpFromInt,BigInteger.prototype.fromString=bnpFromString,BigInteger.prototype.clamp=bnpClamp,BigInteger.prototype.dlShiftTo=bnpDLShiftTo,BigInteger.prototype.drShiftTo=bnpDRShiftTo,BigInteger.prototype.lShiftTo=bnpLShiftTo,BigInteger.prototype.rShiftTo=bnpRShiftTo,BigInteger.prototype.subTo=bnpSubTo,BigInteger.prototype.multiplyTo=bnpMultiplyTo,BigInteger.prototype.squareTo=bnpSquareTo,BigInteger.prototype.divRemTo=bnpDivRemTo,BigInteger.prototype.invDigit=bnpInvDigit,BigInteger.prototype.isEven=bnpIsEven,BigInteger.prototype.exp=bnpExp,BigInteger.prototype.toString=bnToString,BigInteger.prototype.negate=bnNegate,BigInteger.prototype.abs=bnAbs,BigInteger.prototype.compareTo=bnCompareTo,BigInteger.prototype.bitLength=bnBitLength,BigInteger.prototype.mod=bnMod,BigInteger.prototype.modPowInt=bnModPowInt,BigInteger.ZERO=nbv(0),BigInteger.ONE=nbv(1);function Arcfour(){this.i=0,this.j=0,this.S=new Array}function ARC4init(e){var i,s,o;for(i=0;i<256;++i)this.S[i]=i;for(s=0,i=0;i<256;++i)s=s+this.S[i]+e[i%e.length]&255,o=this.S[i],this.S[i]=this.S[s],this.S[s]=o;this.i=0,this.j=0}function ARC4next(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]}Arcfour.prototype.init=ARC4init,Arcfour.prototype.next=ARC4next;function prng_newstate(){return new Arcfour}var rng_psize=256,rng_state,rng_pool,rng_pptr;function rng_seed_int(e){rng_pool[rng_pptr++]^=e&255,rng_pool[rng_pptr++]^=e>>8&255,rng_pool[rng_pptr++]^=e>>16&255,rng_pool[rng_pptr++]^=e>>24&255,rng_pptr>=rng_psize&&(rng_pptr-=rng_psize)}function rng_seed_time(){rng_seed_int(new Date().getTime())}if(rng_pool==null){rng_pool=new Array,rng_pptr=0;var t;if(window.crypto&&window.crypto.getRandomValues){var ua=new Uint8Array(32);for(window.crypto.getRandomValues(ua),t=0;t<32;++t)rng_pool[rng_pptr++]=ua[t]}if(navigator.appName=="Netscape"&&navigator.appVersion<"5"&&window.crypto){var z=window.crypto.random(32);for(t=0;t<z.length;++t)rng_pool[rng_pptr++]=z.charCodeAt(t)&255}for(;rng_pptr<rng_psize;)t=Math.floor(65536*Math.random()),rng_pool[rng_pptr++]=t>>>8,rng_pool[rng_pptr++]=t&255;rng_pptr=0,rng_seed_time()}function rng_get_byte(){if(rng_state==null){for(rng_seed_time(),rng_state=prng_newstate(),rng_state.init(rng_pool),rng_pptr=0;rng_pptr<rng_pool.length;++rng_pptr)rng_pool[rng_pptr]=0;rng_pptr=0}return rng_state.next()}function rng_get_bytes(e){var i;for(i=0;i<e.length;++i)e[i]=rng_get_byte()}function SecureRandom(){}SecureRandom.prototype.nextBytes=rng_get_bytes;function parseBigInt(e,i){return new BigInteger(e,i)}function linebrk(e,i){for(var s="",o=0;o+i<e.length;)s+=e.substring(o,o+i)+"\n",o+=i;return s+e.substring(o,e.length)}function byte2Hex(e){return e<16?"0"+e.toString(16):e.toString(16)}function pkcs1pad2(e,i){if(i<e.length+11)return alert("Message too long for RSA"),null;for(var s=new Array,o=e.length-1;o>=0&&i>0;){var n=e.charCodeAt(o--);n<128?s[--i]=n:n>127&&n<2048?(s[--i]=n&63|128,s[--i]=n>>6|192):(s[--i]=n&63|128,s[--i]=n>>6&63|128,s[--i]=n>>12|224)}s[--i]=0;for(var r=new SecureRandom,h=new Array;i>2;){for(h[0]=0;h[0]==0;)r.nextBytes(h);s[--i]=h[0]}return s[--i]=2,s[--i]=0,new BigInteger(s)}function RSAKey(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function RSASetPublic(e,i){e!=null&&i!=null&&e.length>0&&i.length>0?(this.n=parseBigInt(e,16),this.e=parseInt(i,16)):alert("Invalid RSA public key")}function RSADoPublic(e){return e.modPowInt(this.e,this.n)}function RSAEncrypt(e){var i=pkcs1pad2(e,this.n.bitLength()+7>>3);if(i==null)return null;var s=this.doPublic(i);if(s==null)return null;var o=s.toString(16);return o.length&1?"0"+o:o}RSAKey.prototype.doPublic=RSADoPublic,RSAKey.prototype.setPublic=RSASetPublic,RSAKey.prototype.encrypt=RSAEncrypt;
//# sourceMappingURL=rsa.min.js.map